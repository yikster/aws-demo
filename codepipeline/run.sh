#!/bin/bash
PRD_ACCOUNT_NO=123456789012
ASSUME_ROLE_NAME=STSForDeployProduct
DEV_ACCOUNT_NO=023456789012
REGION=ap-northeast-2
PROJECT_ID=dev-java-ec2
PRODUCT_APP=codedeploy-app
PRODUCT_DEPLOYMENT_GROUP=codedeploy-dg
DEV_INSTANCE_ROLE_ARN="arn:aws:iam::123456789012:role/CodeStarWorker-java-ec3-03-WebApp"
PRD_INSTANCE_ROLE_ARN="arn:aws:iam::023456789012:role/chosun-deployclient-InstanceRole-SQNRDBTQK4X6"
APPROVAL_ARN="arn:aws:sns:ap-northeast-2:123456789012:APP1APPROVAL"

export AWS_PROFILE=profile-prd
python prd_sts_role.py $PROJECT_ID $DEV_ACCOUNT_NO

export AWS_PROFILE=profile-dev

python codepipeline.py $REGION $PROJECT_ID $DEV_ACCOUNT_NO $PRD_ACCOUNT_NO $ASSUME_ROLE_NAME $PRODUCT_APP $PRODUCT_DEPLOYMENT_GROUP $KMS_ARN $DEV_INSTANCE_ROLE_ARN $PRD_INSTANCE_ROLE_ARN $APPROVAL_ARN
